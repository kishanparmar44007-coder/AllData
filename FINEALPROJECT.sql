
CREATE DATABASE PROOJECT;

USE PROOJECT;


CREATE TABLE DEPARTMENT (
    DEPARTMENTID INT PRIMARY KEY,
    DEPARTMENTNAME VARCHAR(30)
);

INSERT INTO DEPARTMENT VALUES
(1, 'CS'),
(2, 'IT'),
(3, 'MATHEMATICS');


CREATE TABLE STUDENT (
    STUID INT PRIMARY KEY,
    FIRSTNAME VARCHAR(20),
    LASTNAME VARCHAR(20),
    EMAIL VARCHAR(50),
    BIRTHDATE DATE,
    ENROLLMENTDATE DATE
);

INSERT INTO STUDENT VALUES
(1, 'RAHUL', 'PATEL', 'RAHUL@GMAIL.COM', '2004-05-10', '2023-07-01'),
(2, 'AMIT', 'SHAH', 'AMIT@GMAIL.COM', '2003-08-15', '2021-07-01'),
(3, 'NEHA', 'DESAI', 'NEHA@GMAIL.COM', '2002-02-20', '2020-06-01');


CREATE TABLE INSTRUCTOR (
    INSTRUCTORID INT PRIMARY KEY,
    FIRSTNAME VARCHAR(20),
    LASTNAME VARCHAR(20),
    EMAIL VARCHAR(50),
    DEPARTMENTID INT,
    SALARY INT,
    FOREIGN KEY (DEPARTMENTID) REFERENCES DEPARTMENT(DEPARTMENTID)
);

INSERT INTO INSTRUCTOR VALUES
(1, 'SURESH', 'MEHTA', 'SURESH@GMAIL.COM', 1, 60000),
(2, 'NEHA', 'DESAI', 'NEHA@GMAIL.COM', 2, 55000),
(3, 'RAJ', 'SHARMA', 'RAJ@GMAIL.COM', 1, 70000);


CREATE TABLE COURSES (
    COURSEID INT PRIMARY KEY,
    COURSENAME VARCHAR(30),
    DEPARTMENTID INT,
    CREDITS INT,
    FOREIGN KEY (DEPARTMENTID) REFERENCES DEPARTMENT(DEPARTMENTID)
);

INSERT INTO COURSES VALUES
(101, 'INTRODUCTION TO SQL', 1, 3),
(102, 'DATA STRUCTURES', 2, 4),
(103, 'DISCRETE MATH', 3, 3);


CREATE TABLE ENROLLMENT (
    ENROLLID INT PRIMARY KEY,
    STUID INT,
    COURSEID INT,
    ENROLLDATE DATE,
    FOREIGN KEY (STUID) REFERENCES STUDENT(STUID),
    FOREIGN KEY (COURSEID) REFERENCES COURSES(COURSEID)
);

INSERT INTO ENROLLMENT VALUES
(1, 1, 101, '2023-07-05'),
(2, 1, 102, '2023-07-06'),
(3, 2, 102, '2021-07-05'),
(4, 3, 101, '2020-06-10');



/* 1 */
SELECT * FROM STUDENT;

/* 2 */
SELECT * FROM STUDENT
WHERE ENROLLMENTDATE > '2022-12-31';

/* 3 */
SELECT C.*
FROM COURSES C
JOIN DEPARTMENT D
ON C.DEPARTMENTID = D.DEPARTMENTID
WHERE D.DEPARTMENTNAME = 'MATHEMATICS'
LIMIT 5;

/* 4 */
SELECT COURSEID, COUNT(STUID) AS TOTAL_STUDENTS
FROM ENROLLMENT
GROUP BY COURSEID
HAVING COUNT(STUID) > 5;

/* 5 */
SELECT STUID
FROM ENROLLMENT
WHERE COURSEID IN (101, 102)
GROUP BY STUID
HAVING COUNT(DISTINCT COURSEID) = 2;

/* 6 */
SELECT DISTINCT STUID
FROM ENROLLMENT
WHERE COURSEID IN (101, 102);

/* 7 */
SELECT AVG(CREDITS) AS AVG_CREDITS
FROM COURSES;

/* 8 */
SELECT MAX(SALARY) AS MAX_SALARY
FROM INSTRUCTOR I
JOIN DEPARTMENT D
ON I.DEPARTMENTID = D.DEPARTMENTID
WHERE D.DEPARTMENTNAME = 'CS';

/* 9 */
SELECT D.DEPARTMENTNAME, COUNT(E.STUID) AS TOTAL_STUDENTS
FROM DEPARTMENT D
JOIN COURSES C ON D.DEPARTMENTID = C.DEPARTMENTID
JOIN ENROLLMENT E ON C.COURSEID = E.COURSEID
GROUP BY D.DEPARTMENTNAME;

/* 10 */
SELECT S.FIRSTNAME, S.LASTNAME, C.COURSENAME
FROM STUDENT S
INNER JOIN ENROLLMENT E ON S.STUID = E.STUID
INNER JOIN COURSES C ON E.COURSEID = C.COURSEID;

/* 11 */
SELECT S.FIRSTNAME, C.COURSENAME
FROM STUDENT S
LEFT JOIN ENROLLMENT E ON S.STUID = E.STUID
LEFT JOIN COURSES C ON E.COURSEID = C.COURSEID;

/* 12 */
SELECT STUID
FROM ENROLLMENT
WHERE COURSEID IN (
    SELECT COURSEID
    FROM ENROLLMENT
    GROUP BY COURSEID
    HAVING COUNT(STUID) > 10
);

/* 13 */
SELECT STUID, YEAR(ENROLLMENTDATE) AS ENROLL_YEAR
FROM STUDENT;

/* 14 */
SELECT CONCAT(FIRSTNAME, ' ', LASTNAME) AS FULL_NAME
FROM INSTRUCTOR;

/* 15 */
SELECT COURSEID,
COUNT(STUID) OVER (ORDER BY COURSEID) AS RUNNING_TOTAL
FROM ENROLLMENT;

/* 16 */
SELECT STUID,
CASE
    WHEN ENROLLMENTDATE <= DATE_SUB(CURDATE(), INTERVAL 4 YEAR)
    THEN 'SENIOR'
    ELSE 'JUNIOR'
END AS STATUS
FROM STUDENT;
