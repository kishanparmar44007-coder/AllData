CREATE DATABASE SCHOOL;

USE SCHOOL;

CREATE TABLE DEPT_MASTER (
    DEPT_CODE INT PRIMARY KEY,
    DEPT_TITLE VARCHAR(100) NOT NULL
);

INSERT INTO DEPT_MASTER VALUES
(1, 'COMPUTER SCIENCE'),
(2, 'MECHANICAL ENGINEERING'),
(3, 'ELECTRICAL ENGINEERING'),
(4, 'MATHEMATICS'),
(5, 'PHYSICS');

CREATE TABLE STUDENT_INFO (
    STUD_ID INT PRIMARY KEY,
    STUD_NAME VARCHAR(100) NOT NULL,
    STUD_AGE INT,
    STUD_CITY VARCHAR(100),
    DEPT_CODE INT,
    STUD_MARKS INT,
    FOREIGN KEY (DEPT_CODE) REFERENCES DEPT_MASTER(DEPT_CODE)
);

INSERT INTO STUDENT_INFO VALUES
(101, 'RAHUL SHARMA', 20, 'DELHI', 1, 85),
(102, 'PRIYA SINGH', 21, 'MUMBAI', 2, 92),
(103, 'AMIT PATEL', 20, 'AHMEDABAD', 1, 78),
(104, 'SNEHA GUPTA', 22, 'BANGALORE', 3, 88),
(105, 'VIKRAM VERMA', 21, 'DELHI', 2, 65);

CREATE TABLE COURSE_LIST (
    COURSE_CODE INT PRIMARY KEY,
    COURSE_TITLE VARCHAR(100),
    DEPT_CODE INT,
    FOREIGN KEY (DEPT_CODE) REFERENCES DEPT_MASTER(DEPT_CODE)
);

INSERT INTO COURSE_LIST VALUES
(501, 'DATA STRUCTURES', 1),
(502, 'THERMODYNAMICS', 2),
(503, 'CIRCUIT ANALYSIS', 3),
(504, 'CALCULUS II', 4),
(505, 'QUANTUM MECHANICS', 5);

CREATE TABLE COURSE_ENROLL (
    ENROLL_NO INT PRIMARY KEY,
    STUD_ID INT,
    COURSE_CODE INT,
    FOREIGN KEY (STUD_ID) REFERENCES STUDENT_INFO(STUD_ID),
    FOREIGN KEY (COURSE_CODE) REFERENCES COURSE_LIST(COURSE_CODE)
);

INSERT INTO COURSE_ENROLL VALUES
(1, 101, 501),
(2, 102, 504),
(3, 103, 501),
(4, 104, 505),
(5, 105, 504);

CREATE TABLE FACULTY (
    FACULTY_ID INT PRIMARY KEY,
    FACULTY_NAME VARCHAR(100),
    DEPT_CODE INT,
    FOREIGN KEY (DEPT_CODE) REFERENCES DEPT_MASTER(DEPT_CODE)
);

INSERT INTO FACULTY VALUES
(301, 'DR. ARVINDER SINGH', 1),
(302, 'PROF. MEERA NAIR', 2),
(303, 'DR. RAJESH KHANNA', 3),
(304, 'DR. SARAH WILLIAMS', 4),
(305, 'PROF. NITIN GADKARI', 1);

SELECT * FROM STUDENT_INFO;

SELECT STUD_NAME, STUD_CITY FROM STUDENT_INFO;

SELECT * FROM STUDENT_INFO WHERE STUD_AGE > 18;

SELECT * FROM STUDENT_INFO WHERE STUD_CITY = 'DELHI';

SELECT * FROM STUDENT_INFO WHERE STUD_MARKS >= 80;

SELECT * FROM STUDENT_INFO ORDER BY STUD_MARKS DESC;

SELECT * FROM STUDENT_INFO ORDER BY STUD_MARKS DESC LIMIT 5;

SELECT * FROM STUDENT_INFO ORDER BY STUD_NAME ASC;

SELECT * FROM STUDENT_INFO WHERE STUD_AGE > 18 AND STUD_MARKS > 75;

SELECT * FROM STUDENT_INFO WHERE STUD_CITY IN ('DELHI','MUMBAI');

SELECT * FROM STUDENT_INFO WHERE STUD_NAME LIKE 'A%';

SELECT * FROM STUDENT_INFO WHERE STUD_MARKS BETWEEN 60 AND 90;

SELECT COUNT(STUD_ID) AS TOTAL_STUDENTS FROM STUDENT_INFO;
SELECT AVG(STUD_MARKS) AS AVG_MARKS FROM STUDENT_INFO;
SELECT MAX(STUD_MARKS) AS TOP_MARKS FROM STUDENT_INFO;

SELECT STUD_CITY, COUNT(*) AS CITY_COUNT
FROM STUDENT_INFO
GROUP BY STUD_CITY;

SELECT S.STUD_NAME, D.DEPT_TITLE
FROM STUDENT_INFO S
JOIN DEPT_MASTER D ON S.DEPT_CODE = D.DEPT_CODE;

SELECT C.COURSE_TITLE, D.DEPT_TITLE
FROM COURSE_LIST C
JOIN DEPT_MASTER D ON C.DEPT_CODE = D.DEPT_CODE;

SELECT S.STUD_NAME, C.COURSE_TITLE
FROM COURSE_ENROLL E
JOIN STUDENT_INFO S ON E.STUD_ID = S.STUD_ID
JOIN COURSE_LIST C ON E.COURSE_CODE = C.COURSE_CODE;

SELECT F.FACULTY_NAME, D.DEPT_TITLE
FROM FACULTY F
JOIN DEPT_MASTER D ON F.DEPT_CODE = D.DEPT_CODE;

SELECT S.STUD_NAME, C.COURSE_TITLE
FROM COURSE_ENROLL E
JOIN STUDENT_INFO S ON E.STUD_ID = S.STUD_ID
JOIN COURSE_LIST C ON E.COURSE_CODE = C.COURSE_CODE
JOIN DEPT_MASTER D ON S.DEPT_CODE = D.DEPT_CODE
WHERE D.DEPT_TITLE = 'COMPUTER SCIENCE';

SELECT S.STUD_NAME
FROM STUDENT_INFO S
LEFT JOIN DEPT_MASTER D ON S.DEPT_CODE = D.DEPT_CODE
WHERE S.DEPT_CODE IS NULL;

SELECT D.DEPT_TITLE
FROM DEPT_MASTER D
LEFT JOIN STUDENT_INFO S ON D.DEPT_CODE = S.DEPT_CODE
WHERE S.STUD_ID IS NULL;

SELECT D.DEPT_TITLE, COUNT(S.STUD_ID) AS TOTAL_STUD
FROM DEPT_MASTER D
LEFT JOIN STUDENT_INFO S ON D.DEPT_CODE = S.DEPT_CODE
GROUP BY D.DEPT_TITLE;

SELECT * FROM STUDENT_INFO
WHERE STUD_MARKS > (SELECT AVG(STUD_MARKS) FROM STUDENT_INFO);

SELECT * FROM STUDENT_INFO
WHERE STUD_MARKS = (SELECT MAX(STUD_MARKS) FROM STUDENT_INFO);

SELECT * FROM STUDENT_INFO
WHERE DEPT_CODE = (
    SELECT DEPT_CODE FROM STUDENT_INFO WHERE STUD_NAME = 'RAHUL SHARMA'
);

SELECT COURSE_TITLE
FROM COURSE_LIST
WHERE COURSE_CODE IN (
    SELECT DISTINCT COURSE_CODE FROM COURSE_ENROLL
);

SELECT STUD_NAME
FROM STUDENT_INFO
WHERE STUD_ID IN (
    SELECT STUD_ID
    FROM COURSE_ENROLL
    GROUP BY STUD_ID
    HAVING COUNT(COURSE_CODE) > 1
);

SELECT DEPT_TITLE
FROM DEPT_MASTER
WHERE DEPT_CODE IN (
    SELECT DEPT_CODE
    FROM STUDENT_INFO
    GROUP BY DEPT_CODE
    HAVING AVG(STUD_MARKS) > 75
);
