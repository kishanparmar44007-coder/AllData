
CREATE DATABASE FRIST;

USE FRIST;

CREATE TABLE CUSTOMER (
CUSTOMERID INT PRIMARY KEY,
NAME  VARCHAR (20) NOT NULL,
EMAIL VARCHAR (30) NOT NULL,
ADDERS VARCHAR (70) NOT NULL
);

INSERT INTO CUSTOMER (CUSTOMERID , NAME , EMAIL , ADDERS)
VALUES
(1, 'Rahul Patel', 'rahul@gmail.com', 'Ahmedabad'),
(2, 'Priya Shah', 'priya@gmail.com', 'Surat'),
(3, 'Amit Mehta', 'amit@gmail.com', 'Vadodara'),
(4, 'Neha Joshi', 'neha@gmail.com', 'Rajkot'),
(5, 'Kunal Desai', 'kunal@gmail.com', 'Bhavnagar'),
(6, 'Pooja Trivedi', 'pooja@gmail.com', 'Jamnagar'),
(7, 'Sagar Parmar', 'sagar@gmail.com', 'Junagadh'),
(8, 'Rina Vyas', 'rina@gmail.com', 'Anand'),
(9, 'Nikhil Chauhan', 'nikhil@gmail.com', 'Nadiad'),
(10, 'Meena Patel', 'meena@gmail.com', 'Gandhinagar');


-- ALL CUSTOMER IN DISPLAY

SELECT * FROM CUSTOMER ; 

-- UPDEAT A CUSTOMER ADDERS 

UPDATE CUSTOMER 
SET ADDERS = 'RAMPUR'
WHERE CUSTOMERID = 6 ;

-- DELET CUSTOMER ID

DELETE FROM CUSTOMER
WHERE CUSTOMERID = 5 ;

-- DISPLAY ALL CUSTOMER WHO NAME IS RAHUL Patel

SELECT * FROM CUSTOMER WHERE NAME = 'RAHUL Patel' ;

CREATE TABLE CUSTOMER (
    CUSTOMERID INT PRIMARY KEY,
    NAME VARCHAR(20),
    EMAIL VARCHAR(30),
    ADDERS VARCHAR(70)
);


CREATE TABLE ORDERED(
ORDERID INT PRIMARY KEY ,
CUSTOMERID INT ,
ORDERDATE DATE NOT NULL
);

CREATE TABLE TOTAL(
TOTALID INT PRIMARY KEY,
AMOUNT INT NOT NULL,
FOREIGN KEY (ORDERID) REFERENCES ORDERED(ORDERID)
);
INSERT INTO TOTAL (TOTALID , AMOUNT)
VALUES
(1 , 2500),
(2 , 1800),
(3 , 3200),
(4 , 1500),
(5 , 2750),
(6 , 4100),
(7 , 2500),
(8 , 990),
(9 , 3600),
(10 , 1950);

INSERT INTO ORDERED (ORDERID , CUSTOMERID , ORDERDATE , TOTALAMOUNT)
VALUES
(101, 1, '2024-01-05', 2500.00),
(102, 2, '2024-01-07', 1800.50),
(103, 3, '2024-01-10', 3200.00),
(104, 4, '2024-01-12', 1500.75),
(105, 5, '2024-01-15', 2750.00),
(106, 6, '2024-01-18', 4100.25),
(107, 7, '2024-01-20', 990.00),
(108, 8, '2024-01-22', 2250.00),
(109, 9, '2024-01-25', 3600.00),
(110, 10, '2024-01-28', 1950.50);

-- UPDATE TOTAL AMOUNT

SELECT SUM(TOTALAMOUNT) AS TOTAL_SUM
FROM ORDERED;
UPDATE ORDERED
SET AMOUNT = 5000
WHERE TOTALID = 1;

-- DELET ORDER BASE ON RODER ID
DELETE FROM ORDERED
WHERE  ORDERID= 1;

-- AGGREGATE FUNCTION

SELECT MAX(TOTALAMOUNT)
AS MAXAMOUNT
FROM ORDERED;

SELECT MIN(TOTALAMOUNT)
AS MAXAMOUNT
FROM ORDERED ;

SELECT AVG(TOTALAMOUNT)
AS MAXAMOUNT
FROM ORDERED ;

-- CREATE TABLE
CREATE TABLE PRODUCTS (
    PRODUCTID INT PRIMARY KEY,
    PRODUCTNAME VARCHAR(50),
    PRICE INT,
    STOCK INT
);

-- INSERT AT LEAST 5 PRODUCTS
INSERT INTO PRODUCTS (PRODUCTID, PRODUCTNAME, PRICE, STOCK) VALUES
(1, 'Laptop', 55000, 10),
(2, 'Mobile', 18000, 5),
(3, 'Keyboard', 1200, 0),
(4, 'Mouse', 800, 20),
(5, 'Monitor', 12000, 8);

-- RETRIEVE ALL PRODUCTS SORTED BY PRICE (DESC)
SELECT * 
FROM PRODUCTS
ORDER BY PRICE DESC;

-- UPDATE PRICE OF A SPECIFIC PRODUCT
UPDATE PRODUCTS
SET PRICE = 900
WHERE PRODUCTID = 4;

-- DELETE PRODUCT IF OUT OF STOCK
DELETE FROM PRODUCTS
WHERE PRODUCTID = 9;

-- RETRIEVE PRODUCTS WITH PRICE BETWEEN 500 AND 2000
SELECT *

FROM PRODUCTS
WHERE PRICE BETWEEN 500 AND 2000;

-- RETRIEVE MOST EXPENSIVE AND CHEAPEST PRODUCT
SELECT 
    MAX(PRICE) AS MOST_EXPENSIVE,
    MIN(PRICE) AS CHEAPEST
FROM PRODUCTS;

CREATE TABLE DTALIS(
ORDERDETALIID INT PRIMARY KEY,
ORDERID INT ,
PRODUCTID INT,
QUANTITY INT,
SUBTOTAL DECIMAL(10,2)
);

INSERT INTO DTALIS(ORDERDETALIID, ORDERID, PRODUCTID,QUANTITY , SUBTOTAL)
VALUES
(1, 101, 1, 2, 1000),
(2, 101, 2, 1, 1500),
(3, 102, 3, 4, 4000),
(4, 103, 1, 1, 500),
(5, 104, 2, 2, 3000);

SELECT ORDERDETALIID
FROM DTALIS
WHERE ORDERID = 102;

SELECT SUM(SUBTOTAL) AS REVNUE
FROM DTALIS;

SELECT PRODUCTID , SUM(QUANTITY)  AS TOPPRODUCT
FROM DTALIS
GROUP BY PRODUCTID
ORDER BY TOPPRODUCT
LIMIT 3;

SELECT COUNT(*) AS TimesSold
FROM DTALIS
WHERE PRODUCTID = 1;

